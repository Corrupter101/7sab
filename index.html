
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>حاسبة بنت السبيته</title>
  <style>
    body {
      font-family: 'Arial';
      direction: rtl;
      background-color: #f0f0f0;
      color: #000;
      text-align: center;
      padding: 20px;
    }
    .player {
      background: #fff;
      margin: 10px auto;
      padding: 15px;
      border-radius: 12px;
      border: 1px solid #ccc;
      width: 280px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .player input {
      font-size: 18px;
      padding: 5px;
      width: 140px;
      text-align: center;
      margin-bottom: 8px;
    }
    .score {
      font-size: 24px;
      font-weight: bold;
      margin: 10px 0;
    }
    .controls button,
    .quick-buttons button {
      font-size: 14px;
      padding: 6px 10px;
      margin: 4px 3px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .quick-buttons {
      margin-top: 10px;
    }
    #dark-mode-toggle {
      position: fixed;
      top: 10px;
      left: 10px;
      background: #333;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 6px 12px;
      cursor: pointer;
    }
    footer {
      margin-top: 30px;
      font-size: 14px;
      color: #666;
    }
  </style>
<script src="https://code.responsivevoice.org/responsivevoice.js?key=WIZiyVE9">
function speakScore(index) {
  const name = document.querySelector(`#score-${index}`).closest('.player').querySelector('input').value;
  const score = scores[index];
  const message = `${name} لديه ${score}`;
  responsiveVoice.speak(message, "Arabic Male");
}

function speakAllScores() {
  let delay = 0;
  for (let i = 0; i < scores.length; i++) {
    const name = document.querySelector(`#score-${i}`).closest('.player').querySelector('input').value;
    const score = scores[i];
    const message = `${name} لديه ${score}`;
    setTimeout(() => responsiveVoice.speak(message, "Arabic Male"), delay);
    delay += 3000; // delay between each voice to avoid overlap
  }
}


function speakAllScores() {
  const messages = [];
  for (let i = 0; i < scores.length; i++) {
    const name = document.querySelector(`#score-${i}`).closest('.player').querySelector('input').value;
    const score = scores[i];
    messages.push(`${name} لديه ${score}`);
  }
  speakMessagesSequentially(messages);
}

function speakMessagesSequentially(messages) {
  if (messages.length === 0) return;
  const message = messages.shift();
  responsiveVoice.speak(message, "Arabic Male", {
    onend: function () {
      speakMessagesSequentially(messages);
    }
  });
}


function updateScoreDisplay(index) {
  document.getElementById("score-" + index).textContent = scores[index];
  highlightPlayers();
  checkGameOver();
}

function highlightPlayers() {
  const max = Math.max(...scores);
  const min = Math.min(...scores);
  for (let i = 0; i < scores.length; i++) {
    const playerDiv = document.getElementById("score-" + i).closest(".player");
    playerDiv.style.backgroundColor = "white"; // reset
    if (scores[i] === max) {
      playerDiv.style.backgroundColor = "#f8d7da"; // loser red
    } else if (scores[i] === min) {
      playerDiv.style.backgroundColor = "#d4edda"; // winner green
    }
  }
}


function checkGameOver() {
  for (let i = 0; i < scores.length; i++) {
    if (scores[i] >= 159) {
      if (!document.getElementById("end-message").style.display) {
        document.getElementById("end-message").style.display = "block";
        document.getElementById("restart-section").style.display = "block";
        disableAllInputs();
      }
      break;
    }
  }
}

  }
}


function disableAllInputs() {
  document.querySelectorAll("button").forEach(btn => {
    const isRestart = btn.id === "restart-button";
    const isDarkToggle = btn.id.includes("dark-mode-toggle");
    if (!isRestart && !isDarkToggle) {
      btn.disabled = true;
      btn.style.opacity = 0.5;
      btn.style.cursor = "not-allowed";
    }
  });
}

  });
}

</script>
</head>
<body>

<img src="عنوان_لصفحة_حاسبة_السبيت.png" alt="عنوان" style="max-width: 180px; display: block; margin: 0 auto 10px;" />

<div class="player">
  <input type="text" value="سالم" readonly />
  <div class="score"><span id="score-0">0</span></div>
  
  <div class="quick-buttons">
    <button onclick="adjustScore(0, 26)" style="background:#6f42c1; color:white;">🖤 بنت +26</button>
    <button onclick="adjustScore(0, 20)" style="background:#ffc107; color:black;">🔟 عشرة +20</button>
    <button onclick="adjustScore(0, 1)" style="background:#e83e8c; color:white;">♥ بنط +1</button>
    <button onclick="adjustScore(0, -10)" style="background:#6c757d; color:white;">📉 مينس -10</button>
  </div>
<button onclick="undoScore(0)" style="margin-top:6px;background:#198754;color:white;border:none;padding:4px 10px;border-radius:5px;">↩ تراجع</button>
</div>

<div class="player">
  <input type="text" value="فهد" readonly />
  <div class="score"><span id="score-1">0</span></div>
  
  <div class="quick-buttons">
    <button onclick="adjustScore(1, 26)" style="background:#6f42c1; color:white;">🖤 بنت +26</button>
    <button onclick="adjustScore(1, 20)" style="background:#ffc107; color:black;">🔟 عشرة +20</button>
    <button onclick="adjustScore(1, 1)" style="background:#e83e8c; color:white;">♥ بنط +1</button>
    <button onclick="adjustScore(1, -10)" style="background:#6c757d; color:white;">📉 مينس -10</button>
  </div>
<button onclick="undoScore(1)" style="margin-top:6px;background:#198754;color:white;border:none;padding:4px 10px;border-radius:5px;">↩ تراجع</button>
</div>

<div class="player">
  <input type="text" value="ناصر" readonly />
  <div class="score"><span id="score-2">0</span></div>
  
  <div class="quick-buttons">
    <button onclick="adjustScore(2, 26)" style="background:#6f42c1; color:white;">🖤 بنت +26</button>
    <button onclick="adjustScore(2, 20)" style="background:#ffc107; color:black;">🔟 عشرة +20</button>
    <button onclick="adjustScore(2, 1)" style="background:#e83e8c; color:white;">♥ بنط +1</button>
    <button onclick="adjustScore(2, -10)" style="background:#6c757d; color:white;">📉 مينس -10</button>
  </div>
<button onclick="undoScore(2)" style="margin-top:6px;background:#198754;color:white;border:none;padding:4px 10px;border-radius:5px;">↩ تراجع</button>
</div>

<div class="player">
  <input type="text" value="أحمد" readonly />
  <div class="score"><span id="score-3">0</span></div>
  
  <div class="quick-buttons">
    <button onclick="adjustScore(3, 26)" style="background:#6f42c1; color:white;">🖤 بنت +26</button>
    <button onclick="adjustScore(3, 20)" style="background:#ffc107; color:black;">🔟 عشرة +20</button>
    <button onclick="adjustScore(3, 1)" style="background:#e83e8c; color:white;">♥ بنط +1</button>
    <button onclick="adjustScore(3, -10)" style="background:#6c757d; color:white;">📉 مينس -10</button>
  </div>
<button onclick="undoScore(3)" style="margin-top:6px;background:#198754;color:white;border:none;padding:4px 10px;border-radius:5px;">↩ تراجع</button>
</div>


<div style="margin-top: 20px;">
  <button onclick="speakAllScores()" style="background:#0d6efd;color:white;border:none;padding:8px 20px;border-radius:8px;font-size:16px;">
    🔊 نشر النتائج
  </button>
</div>


<div id="end-message" style="display:none; margin-top: 20px; font-size: 18px; color: red; font-weight: bold;">
  ❗ انتهت اللعبة!
</div>
<div id="restart-section" style="display:none; margin-top: 10px;">
  <button id="restart-button" onclick="location.reload()" style="background:#198754;color:white;border:none;padding:8px 16px;border-radius:8px;font-size:16px;">🔁 ابدأ جولة جديدة</button>
</div>

<footer>جميع الحقوق محفوظة لحزب الكهف © 2025</footer>

<script>
let scores = [0, 0, 0, 0];
let history = [[], [], [], []];

function adjustScore(index, delta) {
  history[index].push(scores[index]);
  scores[index] += delta;
  updateScoreDisplay(index);
}

function undoScore(index) {
  if (history[index].length > 0) {
    scores[index] = history[index].pop();
    updateScoreDisplay(index);
  }
}

function updateScoreDisplay(index) {
  document.getElementById("score-" + index).textContent = scores[index];
  highlightPlayers();
  checkGameOver();
}

function highlightPlayers() {
  const max = Math.max(...scores);
  const min = Math.min(...scores);
  for (let i = 0; i < scores.length; i++) {
    const playerDiv = document.getElementById("score-" + i).closest(".player");
    playerDiv.style.backgroundColor = "white";
    if (scores[i] === max) {
      playerDiv.style.backgroundColor = "#f8d7da";
    } else if (scores[i] === min) {
      playerDiv.style.backgroundColor = "#d4edda";
    }
  }
}

function checkGameOver() {
  for (let i = 0; i < scores.length; i++) {
    if (scores[i] >= 159) {
      if (document.getElementById("end-message").style.display !== "block") {
        document.getElementById("end-message").style.display = "block";
        document.getElementById("restart-section").style.display = "block";
        disableAllInputs();
      }
      break;
    }
  }
}

function disableAllInputs() {
  document.querySelectorAll("button").forEach(btn => {
    const isRestart = btn.id === "restart-button";
    const isDarkToggle = btn.id.includes("dark-mode-toggle");
    if (!isRestart && !isDarkToggle) {
      btn.disabled = true;
      btn.style.opacity = 0.5;
      btn.style.cursor = "not-allowed";
    }
  });
}

function speakAllScores() {
  const messages = [];
  for (let i = 0; i < scores.length; i++) {
    const name = document.querySelector(`#score-${i}`).closest('.player').querySelector('input').value;
    const score = scores[i];
    messages.push(`${name} لديه ${score}`);
  }
  speakMessagesSequentially(messages);
}

function speakMessagesSequentially(messages) {
  if (messages.length === 0) return;
  const message = messages.shift();
  responsiveVoice.speak(message, "Arabic Male", {
    onend: function () {
      speakMessagesSequentially(messages);
    }
  });
}
</script>

</body>
</html>
